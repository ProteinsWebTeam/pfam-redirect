{"mappings":"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","sources":["config.json","src/get-new-url.js","src/index.js"],"sourcesContent":["{\n  \"basepath\": \"?\",\n  \"interproURL\": \"https://www.ebi.ac.uk/interpro\",\n  \"ebiSearchURL\": \"https://www.ebi.ac.uk/ebisearch/ws/rest/interpro7\",\n  \"test\": false\n}","import { interproURL } from \"../config.json\";\n\nexport const pfamAccessionRegex = /pf\\d{5}(\\.\\d+)?$/i;\nexport const clanAccessionRegex = /cl\\d{4}$/i;\nexport const pdbAccessionRegex = /[a-zA-Z\\d]{4}$/i;\nexport const uniprotAccessionRegex =\n  /[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}$/i;\n\nconst checkAPI = async (type, term) => {\n  let checkURL = null;\n  let targetURL = null;\n  switch (type) {\n    case \"entry\":\n      checkURL = `${ebiSearchURL}?query=(source_database:%22pfam%22)%20AND%20(short_name:%22${term}%22)&format=json`;\n      targetURL = `${interproURL}/entry/pfam/`;\n      break;\n    case \"protein\":\n      checkURL = `${interproURL}/wwwapi/protein/uniprot/${term}`;\n      targetURL = `${interproURL}/wwwapi/protein/uniprot/`;\n      break;\n    case \"clan\":\n      checkURL = `${interproURL}/wwwapi/set/pfam?search=${term}`;\n      targetURL = `${interproURL}/set/pfam/`;\n      break;\n  }\n\n  if (checkURL === null) return null;\n  const response = await fetch(checkURL);\n  if (response.ok) {\n    const payload = await response.json();\n    if ((payload?.results?.length || 0) > 0) {\n      return `${targetURL}${payload.results[0].metadata.accession}`;\n    }\n    if (payload?.metadata?.accession) {\n      return `${targetURL}${payload.metadata.accession}`;\n    }\n    if (payload?.entries?.[0]?.id) {\n      return `${targetURL}${payload.entries[0].id}`;\n    }\n  }\n  return null;\n};\n\nconst getNewURL = async (urlParts) => {\n  let newURL = null;\n\n  switch (urlParts[0].toLowerCase()) {\n    case \"family\":\n      if (pfamAccessionRegex.test(urlParts?.[1])) {\n        newURL = `${interproURL}/entry/pfam/${urlParts[1]?.split(\".\")[0]}`;\n      } else if (urlParts?.[1] === \"browse\") {\n        newURL = `${interproURL}/entry/pfam/`;\n      } else if (urlParts?.[1].length > 0) {\n        newURL = await checkAPI(\"entry\", urlParts[1]);\n      }\n      break;\n    case \"protein\":\n      if (uniprotAccessionRegex.test(urlParts[1])) {\n        newURL = `${interproURL}/protein/uniprot/${urlParts[1]}`;\n      } else {\n        newURL = await checkAPI(\"protein\", urlParts[1]);\n      }\n      break;\n    case \"clan\":\n      if (clanAccessionRegex.test(urlParts[1])) {\n        newURL = `${interproURL}/set/pfam/${urlParts[1]}`;\n      } else if (urlParts?.[1] === \"browse\") {\n        newURL = `${interproURL}/set/pfam/`;\n      } else if (urlParts?.[1].length > 0) {\n        newURL = await checkAPI(\"clan\", urlParts[1]);\n      }\n      break;\n    case \"proteome\":\n      if (!urlParts?.[1] && url.searchParams.get(\"taxId\")) {\n        newURL = `${interproURL}/taxonomy/uniprot/${url.searchParams.get(\n          \"taxId\"\n        )}/entry/pfam/`;\n      } else if (urlParts?.[1] === \"browse\") {\n        newURL = `${interproURL}/taxonomy/uniprot/entry/pfam/`;\n      }\n      break;\n    case \"structure\":\n      if (pdbAccessionRegex.test(urlParts[1])) {\n        newURL = `${interproURL}/structure/pdb/${urlParts[1]}`;\n      }\n      break;\n    case \"browse\":\n      newURL = `${interproURL}/entry/pfam`;\n      break;\n    case \"search\":\n      switch (url.hash) {\n        case \"#tabview=tab0\":\n        case \"#searchSequenceBlock\":\n          newURL = `${interproURL}/search/sequence/`;\n          break;\n        case \"#tabview=tab2\":\n        case \"#searchKeywordBlock\":\n          newURL = `${interproURL}/search/text/`;\n          break;\n        case \"#tabview=tab3\":\n        case \"#searchDomainBlock\":\n          newURL = `${interproURL}/search/ida/`;\n          break;\n        case \"#tabview=tab\":\n        case \"#searchTaxBlock\":\n          newURL = `${interproURL}/taxonomy/uniprot/entry/pfam/`;\n          break;\n      }\n  }\n  return newURL;\n};\n\nexport default getNewURL;\n","import { interproURL, test, basepath } from \"../config.json\";\nimport getNewURL from \"./get-new-url\";\n\n(async () => {\n\n  const url = new URL(document.location.href);\n  let pathname = url.pathname;\n\n  if (url.pathname.startsWith(basepath)) {\n    pathname = url.pathname.slice(basepath.length);\n  } else if (basepath === \"?\") {\n    pathname = url.search.slice(2);\n  } else {\n    console.error(\"The pathname doesn't start with the given base path\");\n  }\n\n  const urlParts = pathname.split(\"/\");\n\n  if (urlParts.length > 1) {\n    document.querySelector(\".redirect\").classList.add(\"show\");\n    let resolvedURL = await getNewURL(urlParts);\n    if (!resolvedURL) {\n      resolvedURL = urlParts?.[1]\n        ? `${interproURL}/search/text/${urlParts[1]}`\n        : interproURL;\n    }\n\n    if (test) {\n      console.log(resolvedURL);\n    } else {\n      window.location.replace(resolvedURL);\n    }\n  }\n  else {\n    document.querySelector(\".fake-home\").classList.add(\"show\");\n  }\n})();\n"],"names":["$16cd91e743f4006e$exports","JSON","parse","$33b4a799b7dd9b4c$export$bb3fcfacbdd848d1","$33b4a799b7dd9b4c$export$eb2a3bf8d4f0e239","$33b4a799b7dd9b4c$export$f04325e91b3c683e","$33b4a799b7dd9b4c$export$44dca26e77862aa3","$33b4a799b7dd9b4c$var$checkAPI","async","type","term","checkURL","targetURL","ebiSearchURL","interproURL","response","fetch","ok","payload","json","results","length","metadata","accession","entries","id","$33b4a799b7dd9b4c$export$2e2bcd8739ae039","urlParts","newURL","toLowerCase","test","split","url","searchParams","get","hash","URL","document","location","href","pathname","startsWith","basepath","slice","search","console","error","querySelector","classList","add","resolvedURL","log","window","replace"],"version":3,"file":"index.9b1f8b0b.js.map"}