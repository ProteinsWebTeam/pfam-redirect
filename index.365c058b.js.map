{"mappings":"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","sources":["config.json","src/index.js"],"sourcesContent":["{\n  \"basepath\": \"?\",\n  \"interproURL\": \"https://www.ebi.ac.uk/interpro\",\n  \"legacyURL\": \"http://pfamdev-legacy.xfam.org\",\n  \"ebiSearchURL\": \"https://www.ebi.ac.uk/ebisearch/ws/rest/interpro7\",\n  \"test\": true\n}","import {\n  basepath,\n  interproURL,\n  legacyURL,\n  ebiSearchURL,\n  test,\n} from \"../config.json\";\n\nconst pfamAccessionRegex = /pf\\d{5}(\\.\\d+)?$/i;\nconst clanAccessionRegex = /cl\\d{4}$/i;\nconst pdbAccessionRegex = /[a-zA-Z\\d]{4}$/i;\nconst uniprotAccessionRegex =\n  /[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}$/i;\n\nlet seqLeft = 9;\nlet playing = true;\n\nconst counterID = setInterval(() => {\n  if (!playing) return;\n  seqLeft = Math.max(seqLeft - 1, 0);\n  document\n    .querySelectorAll(\".sec-left\")\n    .forEach((element) => (element.innerHTML = seqLeft));\n  if (seqLeft === 0) {\n    if (test) console.log(newURL);\n    else window.location.replace(newURL);\n    clearInterval(counterID);\n  }\n}, 1000);\n\nconst checkAPI = async (type, term) => {\n  let checkURL = null;\n  let targetURL = null;\n  switch (type) {\n    case \"entry\":\n      checkURL = `${ebiSearchURL}?query=(source_database:%22pfam%22)%20AND%20(short_name:%22${term}%22)&format=json`;\n      targetURL = `${interproURL}/entry/pfam/`;\n      break;\n    case \"protein\":\n      checkURL = `${interproURL}/api/protein/uniprot/${term}`;\n      targetURL = `${interproURL}/protein/uniprot/`;\n      break;\n    case \"clan\":\n      checkURL = `${interproURL}/api/set/pfam?search=${term}`;\n      targetURL = `${interproURL}/set/pfam/`;\n      break;\n  }\n  if (checkURL === null) return null;\n  const response = await fetch(checkURL);\n  if (response.ok) {\n    const payload = await response.json();\n    if ((payload?.results?.length || 0) > 0) {\n      return `${targetURL}${payload.results[0].metadata.accession}`;\n    }\n    if (payload?.metadata?.accession) {\n      return `${targetURL}${payload.metadata.accession}`;\n    }\n    if (payload?.entries?.[0]?.id) {\n      return `${targetURL}${payload.entries[0].id}`;\n    }\n  }\n  return null;\n};\nlet newURL = null;\n\nconst setNewURL = (theNewURL) => {\n  newURL = theNewURL;\n  if (theNewURL === null) {\n    theNewURL = urlParts?.[1]\n      ? `${interproURL}/search/text/${urlParts[1]}`\n      : interproURL;\n  }\n  const iproLink = document.getElementById(\"linkToInterPro\");\n  iproLink.setAttribute(\"href\", theNewURL);\n  iproLink.innerHTML = theNewURL;\n};\n\nconst url = new URL(document.location.href);\nlet pathname = url.pathname;\nif (url.pathname.startsWith(basepath)) {\n  pathname = url.pathname.slice(basepath.length);\n} else if (basepath === \"?\") {\n  pathname = url.search.slice(2);\n} else {\n  console.error(\"the pathname doesn't start with the given base path\");\n}\nconst urlParts = pathname.split(\"/\");\n\nswitch (urlParts[0].toLowerCase()) {\n  case \"family\":\n    if (pfamAccessionRegex.test(urlParts?.[1])) {\n      newURL = `${interproURL}/entry/pfam/${urlParts[1]?.split(\".\")[0]}`;\n    } else if (urlParts?.[1] === \"browse\") {\n      newURL = `${interproURL}/entry/pfam/`;\n    } else if (urlParts?.[1].length > 0) {\n      newURL = checkAPI(\"entry\", urlParts[1]);\n    }\n    break;\n  case \"protein\":\n    if (uniprotAccessionRegex.test(urlParts[1])) {\n      newURL = `${interproURL}/protein/uniprot/${urlParts[1]}`;\n    } else {\n      newURL = checkAPI(\"protein\", urlParts[1]);\n    }\n    break;\n  case \"clan\":\n    if (clanAccessionRegex.test(urlParts[1])) {\n      newURL = `${interproURL}/set/pfam/${urlParts[1]}`;\n    } else if (urlParts?.[1] === \"browse\") {\n      newURL = `${interproURL}/set/pfam/`;\n    } else if (urlParts?.[1].length > 0) {\n      newURL = checkAPI(\"clan\", urlParts[1]);\n    }\n    break;\n  case \"proteome\":\n    if (!urlParts?.[1] && url.searchParams.get(\"taxId\")) {\n      newURL = `${interproURL}/taxonomy/uniprot/${url.searchParams.get(\n        \"taxId\"\n      )}/entry/pfam/`;\n    } else if (urlParts?.[1] === \"browse\") {\n      newURL = `${interproURL}/taxonomy/uniprot/entry/pfam/`;\n    }\n    break;\n  case \"structure\":\n    if (pdbAccessionRegex.test(urlParts[1])) {\n      newURL = `${interproURL}/structure/pdb/${urlParts[1]}`;\n    }\n    break;\n  case \"browse\":\n    newURL = `${interproURL}/entry/pfam`;\n    break;\n  case \"search\":\n    switch (url.hash) {\n      case \"#tabview=tab0\":\n      case \"#searchSequenceBlock\":\n        newURL = `${interproURL}/search/sequence/`;\n        break;\n      case \"#tabview=tab2\":\n      case \"#searchKeywordBlock\":\n        newURL = `${interproURL}/search/text/`;\n        break;\n      case \"#tabview=tab3\":\n      case \"#searchDomainBlock\":\n        newURL = `${interproURL}/search/ida/`;\n        break;\n      case \"#tabview=tab\":\n      case \"#searchTaxBlock\":\n        newURL = `${interproURL}/taxonomy/uniprot/entry/pfam/`;\n        break;\n    }\n}\n\nconst svg = document.getElementById(\"countdown\");\nsvg.addEventListener(\"click\", () => {\n  playing = !playing;\n  if (playing) {\n    svg.classList.remove(\"paused\");\n  } else {\n    svg.classList.add(\"paused\");\n  }\n});\n\nif (typeof newURL?.then === \"function\") {\n  newURL.then((theNewURL) => setNewURL(theNewURL));\n} else {\n  setNewURL(newURL);\n}\n\nconst legacyNewURL = `${legacyURL}/${pathname}${url.search ?? \"\"}`;\nconst legacyLink = document.getElementById(\"linkToLegacy\");\nlegacyLink.setAttribute(\"href\", legacyNewURL);\nlegacyLink.innerHTML = legacyNewURL;\n"],"names":["$16cd91e743f4006e$exports","JSON","parse","$35da740d59af89ba$var$pfamAccessionRegex","$35da740d59af89ba$var$clanAccessionRegex","$35da740d59af89ba$var$pdbAccessionRegex","$35da740d59af89ba$var$uniprotAccessionRegex","$35da740d59af89ba$var$seqLeft","$35da740d59af89ba$var$playing","$35da740d59af89ba$var$counterID","setInterval","Math","max","document","querySelectorAll","forEach","element","innerHTML","test","console","log","$35da740d59af89ba$var$newURL","window","location","replace","clearInterval","$35da740d59af89ba$var$checkAPI","async","type","term","checkURL","targetURL","ebiSearchURL","interproURL","response","fetch","ok","payload","json","results","length","metadata","accession","entries","id","$35da740d59af89ba$var$setNewURL","theNewURL","$35da740d59af89ba$var$urlParts","iproLink","getElementById","setAttribute","$35da740d59af89ba$var$url","URL","href","$35da740d59af89ba$var$pathname","pathname","startsWith","basepath","slice","search","error","split","toLowerCase","searchParams","get","hash","$35da740d59af89ba$var$svg","addEventListener","classList","remove","add","then","$35da740d59af89ba$var$legacyNewURL","legacyURL","$35da740d59af89ba$var$legacyLink"],"version":3,"file":"index.365c058b.js.map"}